/*! inline 0.0.1 2016-06-06 */
/*   */
!function(a){"use strict";a.wsu=a.wsu||{},a.wsu.editor_preview=function(){var b=this;b.type=null,b.html_id=null,b.iframe=null,b.settings_default={parent:{show:"true",hideat:"",type:"flex-row","media-query-type":"column-at-480",size:"full-width","media-query-size":"",justification:"",content_alignment:""},child:{show:"true",hideat:"",size:"full-width",order:"","media-query-size":"",item_alignment:""}},b.cleanTarget=function(b,c){var d=["grid-","justify-","flex-","order-","full-width-","thirds-","fours-","fifths-","sixths-","eigths-","ninths-","tenths-","twelfths-","wrap","space-","center","column-","row-","hide-below-","full-width"];a.each(d,function(a,c){b.stripClass(c,!1)}),c()},b._layoutItOut=function(c,d){var e=b.iframe.contents();a.each(d,function(d,e){var f=b.iframe.contents().find("."+d);f.length&&(f.addClass("preview_sortable"),b.cleanTarget(f,function(){var b="true";if("undefined"!=typeof e.settings)if("undefined"!=typeof e.settings.show&&(b=""+("false"!==e.settings.show)),"false"===b)f.hide();else{f.show();var c="";a.each(e.settings,function(a,b){"show"!==a&&(c+=" "+b),"size"===a&&(c+=" grid-part "+b)}),f.addClass(c)}})),"undefined"!=typeof e.children&&b._layoutItOut(c,e.children)}),a("#"+b.type+"_options li").off("mouseenter mouseleave"),a("#"+b.type+"_options li").hover(function(){var b=a(this).data("block");e.find("."+b).addClass("preview_hovering")},function(){e.find(".preview_hovering").removeClass("preview_hovering")})},b.set=function(a,c){for(var d=b._layout[b.type],e=a.split("."),f=e.length,g=0;f-1>g;g++){var h=e[g];d[h]||(d[h]={}),d=d[h]}d[e[f-1]]=c},b._updateLayout=function(){a("#"+b.type+"_options li").each(function(){a(this).children("dl").find("dd").each(function(){var c=a(this).data("path"),d=a(this).find(":input").val();b.set(c,d)})}),b._layoutItOut(a("."+b.html_id),b._layout[b.type]),a("#"+b.html_id).val(JSON.stringify(b._layout[b.type]))},b._createInputForm=function(c,d){d=d||"";var e="<ul id='"+b.type+"_options' class='editor_option_list'>",f={};return a.each(c,function(c,g){if(f={},e+="<li data-block='"+c+"'><b>"+c+"</b>","undefined"!=typeof g.settings){var h="";if("customeraccountareas"!==c&&"product_info"!==c&&"productview"!==c&&"productlist"!==c&&"undefined"!=typeof g.children&&(e+="<span class='parent_option'>Options</span>",h="parent"),e+="<dl class='"+h+"'>","customeraccountareas"!==c&&"product_info"!==c&&"productview"!==c&&"productlist"!==c){var i=b.settings_default.child;if(f=a.extend({},i,g.settings),"undefined"!=typeof g.children){var j=b.settings_default.parent;f=a.extend({},j,f)}}a.each(f,function(b,f){e+="<dt>"+b+"</dt>";var g=(""!==d?d+".":"")+c+".settings."+b;a(".type_"+b).find(":selected").attr("selected",!1),a(".type_"+b).find(":selected").removeAttr("selected"),a(".type_"+b).find("[value='"+f+"']").attr("selected",!0);var h=a(".type_"+b).html();e+="<dd data-classes='"+b+"' data-path='"+g+"'>"+h+"</dd>"}),e+="</dl>"}if("undefined"!=typeof g.children){var k=(""!==d?d+".":"")+c+".children";e+=b._createInputForm(g.children,k)}e+="</li>"}),e+="</ul>"},b.ajaxurl=null,b.setupIframe=function(c){var d=b.html_id.split("_");d.pop();var e=a("#"+d.join("_")+"-head");e.closest(".section-config").is(".active")?(c.off("load").on("load",function(){c.contents().find("head").append("<meta name='viewport' content='width=device-width, initial-scale=0.5'/>"),b._layoutItOut(a("."+b.html_id),b._layout[b.type]),c.contents().find("head").append(a("<style type='text/css'> .preview_sortable{ border:1px dashed rgba(0, 0, 0, 0); }  .preview_hovering{ border:1px dashed red; } </style>")),c.siblings(".refresh_iframe").removeClass("loading"),a("#"+b.type+"_options :input").on("change",function(){b._updateLayout(b._layout[b.type])})}),c.siblings(".refresh_iframe").addClass("loading"),""===b.iframe.attr("src")&&b.iframe.attr("src",b.iframe.data("src")),b.iframe.removeClass("iframeClose")):(c.off("load"),b.iframe.attr("src",""),b.iframe.addClass("iframeClose"))},b.setup=function(c){b.html_id=c,b.iframe=a("iframe#layoutframeworkPreview_"+b.html_id),a(document).ready(function(){var c=a("#"+b.html_id);if(c.closest("td").css("width","85%"),c.closest("tr").find("td.label").addClass("editor_options"),c.hide(),""!==c.val())try{var d=c.val(),e=JSON.parse(d);b._layout[b.type]=e}catch(f){console.error(f)}a("#row_"+b.html_id+" td.label").html(b._createInputForm(b._layout[b.type],""));var g=a("#"+b.type+"_options b");g.siblings("span").hide(),g.siblings("dl").hide(),g.siblings("ul").hide(),g.off().on("click",function(){var b=a(this);b.siblings("dl:not(.parent)").toggle(),b.siblings("ul").toggle(),b.siblings("span").toggle(),b.toggleClass("open","close"),b.is(".open")||(b.siblings(".parent_option").hide(),b.siblings(".parent").hide())}),a("#"+b.type+"_options .parent_option").off().on("click",function(){var b=a(this);b.siblings(".parent").toggle(),b.toggleClass("open","close")});var h=b.html_id.split("_");h.pop();var i=a("#"+h.join("_")+"-head");i.on("click",function(){b.setupIframe(b.iframe)}),window.setTimeout(function(){b.setupIframe(b.iframe)},100),null!==b.ajaxurl&&b.iframe.siblings(".refresh_iframe").on("click",function(){var c=a(this);c.addClass("loading"),b.iframe.attr("src",""),a.getJSON(b.ajaxurl).always(function(a){c.removeClass("loading"),b.iframe.attr("src",a._url)})})})},b._layout={productview:{product_info:{settings:{},children:{"product-essential":{settings:{type:"flex-row","media-query-type":"column-at-480"},children:{"product-content":{settings:{type:"flex-column",size:"fifths-3",order:"order-1","media-query-size":"full-width-at-480"},children:{"product-name":{settings:{show:"false"}},email_area:{settings:{order:"order-8"}},review_area:{settings:{order:"order-9"}},alert_urls_area:{settings:{order:"order-7"}},product_type_data_area:{settings:{order:"order-3"}},tier_price_area:{settings:{order:"order-4"}},extrahint_area:{settings:{order:"order-5"}},short_description_area:{settings:{order:"order-1"}},other_area:{settings:{type:"flex-column",order:"order-6"}},add_to_box:{settings:{type:"flex-column",order:"order-6"}},container1_area:{settings:{order:"order-2"},children:{"product-options":{settings:{order:"order-1"}},"product-options-bottom":{settings:{order:"order-2"}}}},description_area:{settings:{order:"order-10"}}}},product_info_media:{settings:{size:"fifths-2",order:"order-2","media-query-size":"full-width-at-480",type:"flex-row"},children:{"product-image":{settings:{size:"sixths-5",order:"order-2"}},"more-views":{settings:{size:"sixths-1",order:"order-1"},children:{"more-views-imgs":{settings:{type:"flex-column"}}}}}}}},"product-collateral":{}}}},productlist:{"category-products":{settings:{type:"flex-row"},children:{"toolbox-top":{settings:{type:"flex-row"},children:{sorting_area:{settings:{order:"order-1",size:""}},filtering_area:{settings:{order:"order-2",size:""}}}},"toolbox-bottom":{settings:{type:"flex-row"},children:{filtering_result_labels:{settings:{order:"order-1"}},limiter:{settings:{order:"order-2"}},sorter:{settings:{order:"order-3"}}}},"category-products-grid":{settings:{type:"flex-row"},children:{item:{settings:{type:"flex-column"},children:{"product-image-wrapper":{settings:{order:"order-1"}},"product-name":{settings:{order:"order-2"}},"rating-area":{settings:{order:"order-3"}},"price-area":{settings:{order:"order-4"}},actions:{settings:{order:"order-5"}},"add-to-links":{settings:{order:"order-6"}}}}}}}}},customeraccountareas:{"account-login":{settings:{type:"flex-row"},children:{"new-users":{settings:{type:"flex-row"}},"registered-users":{settings:{type:"flex-row"}}}},"my-account-dashboard":{settings:{},children:{}}}}}}(jQuery);